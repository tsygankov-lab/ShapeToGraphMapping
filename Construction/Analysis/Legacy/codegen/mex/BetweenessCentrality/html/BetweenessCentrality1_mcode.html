<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> <span class="var type0" id="S2T0U3">betweenness</span> = <span class="message error" id="M1F1C">BetweenessCentrality</span>(<span class="var type0" id="S3T0U6">V</span>,<span class="var type0" id="S4T0U7">E</span>,<span class="var type0" id="S5T0U8">loopStruct</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="var type0" id="S6T0U11">color</span> = <span class="var type0" id="S5T0U13">loopStruct</span>.color;</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% vertSubGraph = loopStruct.subGraphVerts;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="var type0" id="S7T0U17">vertFilterList</span> = <span class="var type0" id="S5T0U19">loopStruct</span>.binaryFilt;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="var type0" id="S8T0U23">location</span> = <span class="var type0" id="S5T0U25">loopStruct</span>.objectNumber;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="var type0" id="S9T0U29">nonLeafVerts</span> = true(size(<span class="var type0" id="S7T0U34">vertFilterList</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="var type0" id="S9T0U38">nonLeafVerts</span>(<span class="var type0" id="S5T0U40">loopStruct</span>.boundaryVerts) = false;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% E = records.edges;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% V = records.verts;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%%Remove these</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="var type0" id="S13T0U46">r2sV</span>              = <span class="var type0" id="S5T0U48">loopStruct</span>.records2SubgraphMap_Vertices;<span class="comment">%find(vertFilterList); %subGraph to records Mapping for vertices</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="var type0" id="S14T0U52">s2rV</span>              = <span class="var type0" id="S5T0U54">loopStruct</span>.subgraph2RecordsMap_Vertices;<span class="comment">%sparse(size(vertFilterList)); %records to subgraph mapping for vertices</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">% r2sV(vertFilterList) = 1:length(s2rV);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="var type0" id="S15T0U58">nonCycleFlag</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="var type0" id="S16T0U62">colorInd</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="var type0" id="S17T0U66">edgeFilterList</span>       = <span class="var type0" id="S4T0U71">E</span>.color(:) == <span class="var type0" id="S6T0U74">color</span> &amp; <span class="var type0" id="S3T0U78">V</span>.borderRegions(<span class="var type0" id="S4T0U82">E</span>.origin(:,1),<span class="var type0" id="S16T0U86">colorInd</span>) == <span class="var type0" id="S8T0U87">location</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% s2rE                 = find(edgeFilterList);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">% r2sE                 = sparse(size(edgeFilterList));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">% r2sE(edgeFilterList) = 1:length(s2rE);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%edgeSubGraph         = records.halfEdge(edgeFilterList,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">% fullGraphBinary = zeros(size(records.vorVert,1),1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="var type0" id="S18T0U90">validStartPoints</span> = find(<span class="var type0" id="S7T0U94">vertFilterList</span> &amp; <span class="var type0" id="S9T0U95">nonLeafVerts</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="var type0" id="S2T0U98">betweenness</span> = zeros(length(<span class="var type0" id="S18T0U103">validStartPoints</span>),1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">mexBetweenessCentrality(<span class="var type0" id="S3T0U108">V</span>,<span class="var type0" id="S4T0U109">E</span>,<span class="var type0" id="S6T0U110">color</span>,<span class="var type0" id="S7T0U111">vertFilterList</span>,<span class="var type0" id="S8T0U112">location</span>,<span class="var type0" id="S13T0U113">r2sV</span>,<span class="var type0" id="S14T0U114">s2rV</span>,<span class="var type0" id="S9T0U115">nonLeafVerts</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="keyword">parfor</span> <span class="var type0" id="S23T0U118">vsp</span> = 1:length(<span class="var type0" id="S18T0U123">validStartPoints</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="var type0" id="S24T0U126">vertexCollectionList</span> = zeros(sum(<span class="var type0" id="S7T0U131">vertFilterList</span>),1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">    <span class="var type0" id="S26T0U135">edgeCollectionList</span>   = zeros(sum(<span class="var type0" id="S17T0U140">edgeFilterList</span>),1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">    <span class="var type0" id="S27T0U144">edgeProcessed</span>        = zeros(size(<span class="var type0" id="S17T0U149">edgeFilterList</span>),<span class="string">'uint8'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">    <span class="var type0" id="S28T0U153">vertexTerminal</span>       = <span class="var type0" id="S3T0U157">V</span>.vertexCoorID(:) ~= -1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="var type0" id="S29T0U164">vertexTerminal_SubGraph</span> = <span class="var type0" id="S3T0U168">V</span>.vertexCoorID(<span class="var type0" id="S7T0U170">vertFilterList</span>) ~= -1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    <span class="var type0" id="S30T0U175">vertexTerminal_SubGraph_Proc</span> = <span class="var type0" id="S29T0U176">vertexTerminal_SubGraph</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="var type0" id="S31T0U179">vertexTerminal_SubGraph_Index</span> = find(<span class="var type0" id="S29T0U182">vertexTerminal_SubGraph</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="var type0" id="S32T0U185">vertexTerminal_circList</span> = zeros(size(<span class="var type0" id="S31T0U190">vertexTerminal_SubGraph_Index</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="var type0" id="S33T0U193">childEdge</span>  = zeros(size(<span class="var type0" id="S14T0U198">s2rV</span>,1),2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="var type0" id="S34T0U203">parentEdge</span> = zeros(size(<span class="var type0" id="S14T0U208">s2rV</span>,1),2); <span class="comment">%%'2' because concave edges can have two parents</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="var type0" id="S35T0U213">radMatrix</span>  = zeros(size(<span class="var type0" id="S14T0U218">s2rV</span>,1),1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">    <span class="var type0" id="S36T0U223">distMatrix</span> = zeros(size(<span class="var type0" id="S14T0U228">s2rV</span>,1),1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">    <span class="var type0" id="S37T0U233">dirMat</span> = zeros(size(<span class="var type0" id="S14T0U238">s2rV</span>,1),2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">    <span class="var type0" id="S38T0U243">startPoint</span> = <span class="var type0" id="S18T0U245">validStartPoints</span>(<span class="var type0" id="S23T0U246">vsp</span>);<span class="comment">%s2rV(startPointID);%records.vorVert(s2rV(startPointID),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">    <span class="var type0" id="S39T0U249">startPointID</span> = <span class="var type0" id="S13T0U251">r2sV</span>(<span class="var type0" id="S38T0U252">startPoint</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">    <span class="var type0" id="S37T0U256">dirMat</span>(1,:) = -[0,1];  <span class="comment">%downward at start</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">    <span class="var type0" id="S35T0U267">radMatrix</span>(1) = <span class="var type0" id="S3T0U271">V</span>.rad(<span class="var type0" id="S38T0U273">startPoint</span>);<span class="comment">%startPoint(3);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">    <span class="var type0" id="S36T0U277">distMatrix</span>(1) = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">    <span class="var type0" id="S24T0U283">vertexCollectionList</span>(1) = <span class="var type0" id="S38T0U285">startPoint</span>;<span class="comment">%s2rV(startPointID);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">    <span class="var type0" id="S34T0U289">parentEdge</span>((<span class="var type0" id="S39T0U291">startPointID</span>),1) = -1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">    <span class="var type0" id="S40T0U297">endState</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="var type0" id="S41T0U301">iter</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">    <span class="var type0" id="S42T0U305">dbgplot</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">    <span class="var type0" id="S43T0U309">reversing</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">    <span class="var type0" id="S44T0U313">terminals</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">    <span class="var type0" id="S45T0U317">startingVertexInd</span> = <span class="var type0" id="S24T0U319">vertexCollectionList</span>(1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">    <span class="comment">%%loop until a termination condition has been met</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">    <span class="keyword">while</span>(~<span class="var type0" id="S40T0U324">endState</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">        <span class="comment">%     if(totalCount == 187)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">        <span class="comment">%         disp('pause')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">        <span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">        <span class="var type0" id="S46T0U327">curVert</span> = <span class="var type0" id="S24T0U329">vertexCollectionList</span>(<span class="var type0" id="S41T0U330">iter</span>);<span class="comment">%records.vorVert(vertexCollectionList(iter),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">        <span class="keyword">if</span>(~<span class="var type0" id="S28T0U336">vertexTerminal</span>(<span class="var type0" id="S24T0U338">vertexCollectionList</span>(<span class="var type0" id="S41T0U339">iter</span>))) <span class="comment">%%If it is not a terminal vertex<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">            <span class="keyword">if</span>(<span class="var type0" id="S34T0U345">parentEdge</span>(<span class="var type0" id="S13T0U347">r2sV</span>(<span class="var type0" id="S24T0U349">vertexCollectionList</span>(<span class="var type0" id="S41T0U350">iter</span>)),2) == 0) <span class="comment">%%Store the parent edge</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">                <span class="var type0" id="S47T0U355">parEdge</span> = <span class="var type0" id="S34T0U357">parentEdge</span>(<span class="var type0" id="S13T0U359">r2sV</span>(<span class="var type0" id="S24T0U361">vertexCollectionList</span>(<span class="var type0" id="S41T0U362">iter</span>)),1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">                <span class="var type0" id="S47T0U367">parEdge</span> = <span class="var type0" id="S34T0U369">parentEdge</span>(<span class="var type0" id="S13T0U371">r2sV</span>(<span class="var type0" id="S24T0U373">vertexCollectionList</span>(<span class="var type0" id="S41T0U374">iter</span>)),2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">            <span class="var type0" id="S48T0U378">edgeIndexMatrixFiltConnected</span>  = <span class="var type0" id="S3T0U381">V</span>.edgeIDList(<span class="var type0" id="S46T0U383">curVert</span>,1:<span class="var type0" id="S3T0U388">V</span>.degree(<span class="var type0" id="S46T0U390">curVert</span>));<span class="comment">%curVert(9:8+curVert(8));		%%Edges connected to this vertex</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">            <span class="var type0" id="S49T0U393">edgeIndexMatrixFiltInSubGraph</span> = <span class="var type0" id="S48T0U395">edgeIndexMatrixFiltConnected</span>(<span class="var type0" id="S17T0U397">edgeFilterList</span>(<span class="var type0" id="S48T0U398">edgeIndexMatrixFiltConnected</span>));  <span class="comment">%%Edges in subgraph region</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">            <span class="var type0" id="S50T0U401">edgeIndexMatrixFiltNoReverse</span>  = <span class="var type0" id="S49T0U403">edgeIndexMatrixFiltInSubGraph</span>((<span class="var type0" id="S49T0U406">edgeIndexMatrixFiltInSubGraph</span>) ~= <span class="var type0" id="S47T0U407">parEdge</span>); <span class="comment">%%Edge is not an immediate reversal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">            <span class="var type0" id="S51T0U410">edgeIndexMatrixFinal</span>          = <span class="var type0" id="S50T0U412">edgeIndexMatrixFiltNoReverse</span>(~<span class="var type0" id="S27T0U415">edgeProcessed</span>(<span class="var type0" id="S50T0U416">edgeIndexMatrixFiltNoReverse</span>)); <span class="comment">%%Edge has not been touched</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">            <span class="keyword">if</span>(isempty(<span class="var type0" id="S51T0U424">edgeIndexMatrixFinal</span>) &amp;&amp; <span class="var type0" id="S24T0U427">vertexCollectionList</span>(<span class="var type0" id="S41T0U428">iter</span>) == <span class="var type0" id="S45T0U429">startingVertexInd</span> &amp;&amp; <span class="var type0" id="S15T0U430">nonCycleFlag</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">                <span class="comment">%%all paths exhausted, terminate<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">                <span class="var type0" id="S41T0U433">iter</span> = <span class="var type0" id="S41T0U435">iter</span> + 1; <span class="comment">%to not purge information<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">                <span class="var type0" id="S40T0U439">endState</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">                <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">            <span class="keyword">elseif</span>(isempty(<span class="var type0" id="S51T0U446">edgeIndexMatrixFinal</span>)) <span class="comment">%%If no edges are valid, reverse</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">                <span class="var type0" id="S41T0U449">iter</span> = <span class="var type0" id="S41T0U451">iter</span> - 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">                <span class="keyword">if</span>(<span class="var type0" id="S42T0U456">dbgplot</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">                    plot(<span class="var type0" id="S3T0U462">V</span>.pos(<span class="var type0" id="S46T0U464">curVert</span>,1),<span class="var type0" id="S3T0U468">V</span>.pos(<span class="var type0" id="S46T0U470">curVert</span>,2),<span class="string">'rx'</span>,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">                    xlim([<span class="var type0" id="S3T0U485">V</span>.pos(<span class="var type0" id="S46T0U487">curVert</span>,1)-20,<span class="var type0" id="S3T0U493">V</span>.pos(<span class="var type0" id="S46T0U495">curVert</span>,1)+20]);</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">                    ylim([<span class="var type0" id="S3T0U506">V</span>.pos(<span class="var type0" id="S46T0U508">curVert</span>,2)-20,<span class="var type0" id="S3T0U514">V</span>.pos(<span class="var type0" id="S46T0U516">curVert</span>,2)+20]);</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">                    <span class="comment">%                 f = getframe;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">                    <span class="var type0" id="S56T0U521">totalCount</span> = <span class="var type0" id="S56T0U523">totalCount</span> + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">                    <span class="comment">%                 imwrite(f.cdata,strcat('D:\Miracles\uglyAGAIN',num2str(totalCount), '.tiff'));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">                    drawnow;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">                <span class="var type0" id="S43T0U530">reversing</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">                <span class="keyword">if</span>(<span class="var type0" id="S42T0U537">dbgplot</span> &amp;&amp; ~<span class="var type0" id="S43T0U539">reversing</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">                    plot(<span class="var type0" id="S3T0U545">V</span>.pos(<span class="var type0" id="S46T0U547">curVert</span>,1),<span class="var type0" id="S3T0U551">V</span>.pos(<span class="var type0" id="S46T0U553">curVert</span>,2),<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">                    xlim([<span class="var type0" id="S3T0U568">V</span>.pos(<span class="var type0" id="S46T0U570">curVert</span>,1)-20,<span class="var type0" id="S3T0U576">V</span>.pos(<span class="var type0" id="S46T0U578">curVert</span>,1)+20]);</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">                    ylim([<span class="var type0" id="S3T0U589">V</span>.pos(<span class="var type0" id="S46T0U591">curVert</span>,2)-20,<span class="var type0" id="S3T0U597">V</span>.pos(<span class="var type0" id="S46T0U599">curVert</span>,2)+20]);</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">                    <span class="var type0" id="S56T0U604">totalCount</span> = <span class="var type0" id="S56T0U606">totalCount</span> + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">                    <span class="comment">%                 f = getframe;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">                    <span class="comment">%                 imwrite(f.cdata,strcat('D:\Miracles\uglyAGAIN',num2str(totalCount), '.tiff'));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">                    drawnow;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">                <span class="var type0" id="S43T0U613">reversing</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">                <span class="keyword">if</span>(length(<span class="var type0" id="S51T0U621">edgeIndexMatrixFinal</span>) == 1) <span class="comment">%%Don't test if only one edge is there</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">                    <span class="var type0" id="S58T0U625">edgeInd</span> = <span class="var type0" id="S51T0U626">edgeIndexMatrixFinal</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">                    <span class="var type0" id="S59T0U630">angleMat</span> = zeros(size(<span class="var type0" id="S51T0U635">edgeIndexMatrixFinal</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">                    <span class="keyword">for</span> <span class="var type0" id="S60T0U638">i</span> = 1:length(<span class="var type0" id="S51T0U643">edgeIndexMatrixFinal</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">                        <span class="var type0" id="S61T0U646">edge</span> = <span class="var type0" id="S51T0U648">edgeIndexMatrixFinal</span>(<span class="var type0" id="S60T0U649">i</span>);<span class="comment">%records.halfEdge(edgeIndexMatrixFinal(i),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">                        <span class="var type0" id="S62T0U652">twinEdge</span> = <span class="var type0" id="S4T0U655">E</span>.twinID(<span class="var type0" id="S61T0U657">edge</span>);<span class="comment">%records.halfEdge(edge(1),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">                        <span class="keyword">if</span>(sqrt(<span class="var type0" id="S4T0U668">E</span>.dir(<span class="var type0" id="S61T0U670">edge</span>,1)^2 + <span class="var type0" id="S4T0U676">E</span>.dir(<span class="var type0" id="S61T0U678">edge</span>,2)^2) &lt; sqrt(eps))</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">                            <span class="comment">%This code branch is outdated, but there for safety</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">                            <span class="var type0" id="S65T0U687">noEdgeFound</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">                            <span class="var type0" id="S66T0U691">parEdge_T</span> = <span class="var type0" id="S4T0U694">E</span>.twinID(<span class="var type0" id="S61T0U696">edge</span>);<span class="comment">%edge(1); %%Twin edge, temporary parent edge for this cycle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">                            <span class="var type0" id="S67T0U699">twinVert</span> = <span class="var type0" id="S4T0U702">E</span>.origin(<span class="var type0" id="S61T0U704">edge</span>,2);<span class="comment">%records.vorVert(edge(4),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">                            <span class="keyword">while</span>(<span class="var type0" id="S65T0U708">noEdgeFound</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">                                <span class="var type0" id="S68T0U711">zeroedgeIndexMatrixFiltConnected</span>  = <span class="var type0" id="S4T0U714">E</span>.edgeIDList(<span class="var type0" id="S67T0U716">twinVert</span>,1:<span class="var type0" id="S3T0U721">V</span>.degree(<span class="var type0" id="S67T0U723">twinVert</span>));<span class="comment">%twinVert(9:8+twinVert(8));		%%Edges connected to this vertex</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">                                <span class="var type0" id="S69T0U726">zeroedgeIndexMatrixFiltInSubGraph</span> = <span class="var type0" id="S68T0U728">zeroedgeIndexMatrixFiltConnected</span>(<span class="var type0" id="S17T0U730">edgeFilterList</span>(<span class="var type0" id="S68T0U731">zeroedgeIndexMatrixFiltConnected</span>));  <span class="comment">%%Edges in subgraph region</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">                                <span class="var type0" id="S70T0U734">zeroedgeIndexMatrixFiltNoReverse</span>  = <span class="var type0" id="S69T0U736">zeroedgeIndexMatrixFiltInSubGraph</span>((<span class="var type0" id="S69T0U739">zeroedgeIndexMatrixFiltInSubGraph</span>) ~= <span class="var type0" id="S66T0U740">parEdge_T</span>); <span class="comment">%%Edge is not an immediate reversal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">                                <span class="var type0" id="S71T0U743">zeroedgeIndexMatrixFinal</span>          = <span class="var type0" id="S70T0U745">zeroedgeIndexMatrixFiltNoReverse</span>(~<span class="var type0" id="S27T0U748">edgeProcessed</span>(<span class="var type0" id="S70T0U749">zeroedgeIndexMatrixFiltNoReverse</span>)); <span class="comment">%%Edge has not been touched</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">                                <span class="keyword">if</span>(isempty(<span class="var type0" id="S71T0U755">zeroedgeIndexMatrixFinal</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">                                    <span class="comment">%If this is true, this path might lead to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">                                    <span class="comment">%a vertex? - Or on terminating iteration</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">                                    <span class="var type0" id="S65T0U758">noEdgeFound</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">                                    <span class="var type0" id="S59T0U763">angleMat</span>(<span class="var type0" id="S60T0U764">i</span>) = -2; <span class="comment">%%Only occurs on the terminating iteration<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">                                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">                                    <span class="keyword">for</span> <span class="var type0" id="S72T0U770">j</span> = 1:length(<span class="var type0" id="S71T0U775">zeroedgeIndexMatrixFinal</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">                                        <span class="var type0" id="S73T0U778">zeroEdge</span> = <span class="var type0" id="S71T0U780">zeroedgeIndexMatrixFinal</span>(<span class="var type0" id="S72T0U781">j</span>);<span class="comment">%records.halfEdge(zeroedgeIndexMatrixFinal(j),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">                                        <span class="keyword">if</span>(sqrt(<span class="var type0" id="S4T0U792">E</span>.dir(<span class="var type0" id="S73T0U794">zeroEdge</span>,1)^2 + <span class="var type0" id="S4T0U800">E</span>.dir(<span class="var type0" id="S73T0U802">zeroEdge</span>,2)^2) &gt; sqrt(eps(max([<span class="var type0" id="S3T0U815">V</span>.pos(<span class="var type0" id="S4T0U819">E</span>.origin(<span class="var type0" id="S62T0U821">twinEdge</span>,1),1:2)]))))</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">                                            <span class="comment">%%as long as the edge has a valid direction and its not a reversal it is fine.  The left most edge of one branch can not be to the left of the rightmost edge of the other if it is truly to the right</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">                                            <span class="var type0" id="S59T0U829">angleMat</span>(<span class="var type0" id="S60T0U830">i</span>) = angleBetween(<span class="var type0" id="S37T0U834">dirMat</span>(<span class="var type0" id="S41T0U835">iter</span>,:),<span class="var type0" id="S4T0U839">E</span>.dir(<span class="var type0" id="S73T0U841">zeroEdge</span>,:));<span class="comment">%zeroEdge(6:7)); %Alt - grab a linear dist calculation from the previous point</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">                                            <span class="var type0" id="S65T0U845">noEdgeFound</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">                                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">                                            <span class="var type0" id="S66T0U850">parEdge_T</span> = <span class="var type0" id="S4T0U853">E</span>.twinID(<span class="var type0" id="S73T0U855">zeroEdge</span>);<span class="comment">%zeroEdge(1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">                                            <span class="var type0" id="S67T0U858">twinVert</span> = <span class="var type0" id="S4T0U861">E</span>.origin(<span class="var type0" id="S73T0U863">zeroEdge</span>,2);<span class="comment">%records.vorVert(zeroEdge(4),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">                            <span class="var type0" id="S59T0U869">angleMat</span>(<span class="var type0" id="S60T0U870">i</span>) = angleBetween(<span class="var type0" id="S37T0U874">dirMat</span>(<span class="var type0" id="S41T0U875">iter</span>,:),<span class="var type0" id="S4T0U879">E</span>.dir(<span class="var type0" id="S61T0U881">edge</span>,:));<span class="comment">%edge(6:7));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">                    [~,<span class="var type0" id="S76T0U887">ind</span>] = min(<span class="var type0" id="S59T0U890">angleMat</span>); <span class="comment">%%for CCW selection</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">                    <span class="var type0" id="S58T0U893">edgeInd</span> = <span class="var type0" id="S51T0U895">edgeIndexMatrixFinal</span>(<span class="var type0" id="S76T0U896">ind</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">                <span class="var type0" id="S26T0U900">edgeCollectionList</span>(<span class="var type0" id="S41T0U901">iter</span>) = <span class="var type0" id="S58T0U902">edgeInd</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">                <span class="var type0" id="S27T0U906">edgeProcessed</span>(<span class="var type0" id="S58T0U907">edgeInd</span>) = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">                <span class="var type0" id="S61T0U911">edge</span> = <span class="var type0" id="S58T0U912">edgeInd</span>;<span class="comment">%records.halfEdge(edgeInd,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">                <span class="var type0" id="S41T0U915">iter</span> = <span class="var type0" id="S41T0U917">iter</span> + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">                <span class="keyword">if</span>(<span class="var type0" id="S4T0U925">E</span>.origin(<span class="var type0" id="S61T0U927">edge</span>,2) == <span class="var type0" id="S45T0U929">startingVertexInd</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">                    <span class="comment">%%TERMINATE LOOP - DO NOT STORE MORE INFORMATION</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">                    <span class="var type0" id="S40T0U932">endState</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">                    <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">                    <span class="var type0" id="S24T0U939">vertexCollectionList</span>(<span class="var type0" id="S41T0U940">iter</span>) = <span class="var type0" id="S4T0U943">E</span>.origin(<span class="var type0" id="S61T0U945">edge</span>,2);<span class="comment">%(edge(4));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">                    <span class="var type0" id="S78T0U949">subGraphIndOld</span> = <span class="var type0" id="S13T0U951">r2sV</span>(<span class="var type0" id="S24T0U953">vertexCollectionList</span>(<span class="var type0" id="S41T0U955">iter</span>-1));</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">                    <span class="var type0" id="S79T0U959">subGraphIndNew</span> = <span class="var type0" id="S13T0U961">r2sV</span>(<span class="var type0" id="S24T0U963">vertexCollectionList</span>(<span class="var type0" id="S41T0U964">iter</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">                    <span class="keyword">if</span>(<span class="var type0" id="S34T0U970">parentEdge</span>(<span class="var type0" id="S79T0U971">subGraphIndNew</span>,1) == 0)</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">                        <span class="var type0" id="S34T0U977">parentEdge</span>(<span class="var type0" id="S79T0U978">subGraphIndNew</span>,1) = <span class="var type0" id="S4T0U982">E</span>.twinID(<span class="var type0" id="S61T0U984">edge</span>);<span class="comment">%edge(1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">                    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">                        <span class="var type0" id="S34T0U989">parentEdge</span>(<span class="var type0" id="S79T0U990">subGraphIndNew</span>,2) = <span class="var type0" id="S4T0U994">E</span>.twinID(<span class="var type0" id="S61T0U996">edge</span>);<span class="comment">%edge(1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line">                    <span class="keyword">if</span>(<span class="var type0" id="S33T0U1002">childEdge</span>(<span class="var type0" id="S78T0U1003">subGraphIndOld</span>,1) == 0)</span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line">                        <span class="var type0" id="S33T0U1009">childEdge</span>(<span class="var type0" id="S78T0U1010">subGraphIndOld</span>,1) = <span class="var type0" id="S58T0U1012">edgeInd</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">                    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">                        <span class="var type0" id="S33T0U1017">childEdge</span>(<span class="var type0" id="S78T0U1018">subGraphIndOld</span>,2) = <span class="var type0" id="S58T0U1020">edgeInd</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">                    <span class="keyword">if</span>(<span class="var type0" id="S4T0U1027">E</span>.dist(<span class="var type0" id="S61T0U1029">edge</span>) &lt; sqrt(eps(max([<span class="var type0" id="S3T0U1040">V</span>.pos(<span class="var type0" id="S4T0U1044">E</span>.origin(<span class="var type0" id="S61T0U1046">edge</span>,2),1:2)]))))</span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">                        <span class="var type0" id="S37T0U1054">dirMat</span>(<span class="var type0" id="S41T0U1055">iter</span>,:) = <span class="var type0" id="S37T0U1058">dirMat</span>(<span class="var type0" id="S41T0U1060">iter</span>-1,:);</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">                    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">                        <span class="var type0" id="S37T0U1067">dirMat</span>(<span class="var type0" id="S41T0U1068">iter</span>,:) = -<span class="var type0" id="S4T0U1073">E</span>.dir(<span class="var type0" id="S4T0U1077">E</span>.twinID(<span class="var type0" id="S61T0U1079">edge</span>),:);<span class="comment">%-records.halfEdge(edge(1),6:7);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">                    <span class="var type0" id="S36T0U1084">distMatrix</span>(<span class="var type0" id="S41T0U1085">iter</span>) = <span class="var type0" id="S4T0U1088">E</span>.dist(<span class="var type0" id="S61T0U1090">edge</span>);<span class="comment">%edge(5);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line">                    <span class="var type0" id="S35T0U1094">radMatrix</span>(<span class="var type0" id="S41T0U1095">iter</span>) = <span class="var type0" id="S3T0U1098">V</span>.rad(<span class="var type0" id="S24T0U1101">vertexCollectionList</span>(<span class="var type0" id="S41T0U1102">iter</span>));<span class="comment">%records.vorVert(vertexCollectionList(iter),3);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">            <span class="keyword">if</span>(<span class="var type0" id="S30T0U1109">vertexTerminal_SubGraph_Proc</span>(<span class="var type0" id="S13T0U1111">r2sV</span>(<span class="var type0" id="S24T0U1113">vertexCollectionList</span>(<span class="var type0" id="S41T0U1114">iter</span>))) == 1)</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">                <span class="var type0" id="S30T0U1119">vertexTerminal_SubGraph_Proc</span>(<span class="var type0" id="S13T0U1121">r2sV</span>(<span class="var type0" id="S24T0U1123">vertexCollectionList</span>(<span class="var type0" id="S41T0U1124">iter</span>))) = 0; <span class="comment">%Found</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line">                <span class="var type0" id="S44T0U1128">terminals</span> = <span class="var type0" id="S44T0U1130">terminals</span> + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line">                <span class="var type0" id="S32T0U1135">vertexTerminal_circList</span>(<span class="var type0" id="S44T0U1136">terminals</span>) = <span class="var type0" id="S13T0U1138">r2sV</span>(<span class="var type0" id="S24T0U1140">vertexCollectionList</span>(<span class="var type0" id="S41T0U1141">iter</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">                <span class="keyword">if</span>(<span class="var type0" id="S42T0U1145">dbgplot</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line">                    plot(<span class="var type0" id="S3T0U1151">V</span>.pos(<span class="var type0" id="S46T0U1153">curVert</span>,1),<span class="var type0" id="S3T0U1157">V</span>.pos(<span class="var type0" id="S46T0U1159">curVert</span>,2),<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'g'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">                    plot(<span class="var type0" id="S3T0U1171">V</span>.pos(<span class="var type0" id="S46T0U1173">curVert</span>,1),<span class="var type0" id="S3T0U1177">V</span>.pos(<span class="var type0" id="S46T0U1179">curVert</span>,2),<span class="string">'rx'</span>,<span class="string">'MarkerSize'</span>,6,<span class="string">'MarkerFaceColor'</span>,<span class="string">'r'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">                    xlim([<span class="var type0" id="S3T0U1194">V</span>.pos(<span class="var type0" id="S46T0U1196">curVert</span>,1)-20,<span class="var type0" id="S3T0U1202">V</span>.pos(<span class="var type0" id="S46T0U1204">curVert</span>,1)+20]);</span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">                    ylim([<span class="var type0" id="S3T0U1215">V</span>.pos(<span class="var type0" id="S46T0U1217">curVert</span>,2)-20,<span class="var type0" id="S3T0U1223">V</span>.pos(<span class="var type0" id="S46T0U1225">curVert</span>,2)+20]);</span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">                    <span class="comment">%                 f = getframe;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">                    <span class="comment">%                 imwrite(f.cdata,strcat('D:\Miracles\uglyAGAIN',num2str(totalCount), '.tiff'));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">                    drawnow;</span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">            <span class="var type0" id="S43T0U1233">reversing</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">            <span class="var type0" id="S41T0U1237">iter</span> = <span class="var type0" id="S41T0U1239">iter</span> - 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line">    <span class="var type0" id="S24T0U1244">vertexCollectionList</span>(<span class="var type0" id="S41T0U1246">iter</span>:end) = [];</span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">    <span class="comment">% edgeCollectionList(iter:end) = [];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">    <span class="var type0" id="S37T0U1254">dirMat</span>(<span class="var type0" id="S41T0U1256">iter</span>:end,:) = [];</span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">    <span class="comment">% radMatrix(iter:end) = [];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line">    <span class="comment">% distMatrix(iter:end) = [];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line">    <span class="comment">% loopStruct.Vertices = vertexCollectionList;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line">    <span class="comment">% loopStruct.EL = edgeCollectionList;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">    <span class="comment">% loopStruct.subGraphVerts = vertSubGraph;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">    <span class="comment">% loopStruct.subGraphParentEdge = parentEdge;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">    <span class="comment">% loopStruct.subGraphChildEdge = childEdge;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line">    <span class="comment">% loopStruct.direction = dirMat;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">    <span class="comment">% loopStruct.incrDist = distMatrix;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">    <span class="comment">% loopStruct.distance = cumsum(distMatrix);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line">    <span class="comment">% if(nonCycleFlag)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line">    <span class="comment">%     loopStruct.totalDistance = 0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line">    <span class="comment">% else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line">    <span class="comment">%     loopStruct.totalDistance = loopStruct.distance(end) + E.dist(edgeCollectionList(end));%records.halfEdge(edgeCollectionList(end),5);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line">    <span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line">    <span class="comment">% loopStruct.radius = radMatrix;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line">    <span class="comment">% loopStruct.records2SubgraphMap_Vertices = r2sV;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line">    <span class="comment">% loopStruct.subgraph2RecordsMap_Vertices = s2rV;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line">    <span class="comment">% loopStruct.binaryFilt = vertFilterList;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line">    <span class="comment">%loopStruct.subGraphEL = edgeSubGraph;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234">234</a></span><span class="line">    <span class="comment">% loopStruct.records2SubgraphMap_EL = r2sE;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235">235</a></span><span class="line">    <span class="comment">% loopStruct.records2SubgraphMap_EL = r2sE;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236">236</a></span><span class="line">    <span class="comment">% loopStruct.objectNumber = location;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237">237</a></span><span class="line">    <span class="comment">% loopStruct.color = color;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238">238</a></span><span class="line">    <span class="comment">% loopStruct.inObject = inObject;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239">239</a></span><span class="line">    <span class="comment">% loopStruct.subGraphLeafFilter = vertexTerminal_SubGraph;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240">240</a></span><span class="line">    <span class="comment">% loopStruct.nonCycle = nonCycleFlag;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241">241</a></span><span class="line">    <span class="var type0" id="S81T0U1264">isOnBridge</span> = false(<span class="var type0" id="S3T0U1268">V</span>.length,1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242">242</a></span><span class="line">    <span class="var type0" id="S81T0U1274">isOnBridge</span>(<span class="var type0" id="S24T0U1275">vertexCollectionList</span>) = true;</span></span>
<span class="srcline"><span class="lineno"><a href="1,243" id="srcline243">243</a></span><span class="line">    <span class="var type0" id="S82T0U1280">distMat</span> = zeros(size(<span class="var type0" id="S32T0U1285">vertexTerminal_circList</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,244" id="srcline244">244</a></span><span class="line">    <span class="var type0" id="S83T0U1288">vertTerminal_circList_rootNode</span> = zeros(size(<span class="var type0" id="S32T0U1293">vertexTerminal_circList</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,245" id="srcline245">245</a></span><span class="line">    <span class="var type0" id="S84T0U1296">boundaryVertexCoor</span> = zeros(size(<span class="var type0" id="S83T0U1301">vertTerminal_circList_rootNode</span>,1),2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,246" id="srcline246">246</a></span><span class="line">    <span class="keyword">for</span> <span class="var type0" id="S60T0U1306">i</span> = 1:length(<span class="var type0" id="S32T0U1311">vertexTerminal_circList</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,247" id="srcline247">247</a></span><span class="line">        <span class="comment">%     if(i == 498)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248">248</a></span><span class="line">        <span class="comment">%         disp('rev')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249">249</a></span><span class="line">        <span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250">250</a></span><span class="line">        <span class="var type0" id="S85T0U1314">vertInd</span> = <span class="var type0" id="S14T0U1316">s2rV</span>(<span class="var type0" id="S32T0U1318">vertexTerminal_circList</span>(<span class="var type0" id="S60T0U1319">i</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251">251</a></span><span class="line">        <span class="var type0" id="S84T0U1323">boundaryVertexCoor</span>(<span class="var type0" id="S60T0U1324">i</span>,:) = <span class="var type0" id="S3T0U1328">V</span>.pos(<span class="var type0" id="S85T0U1330">vertInd</span>,:);<span class="comment">%records.vorVert(vertInd,1:2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252">252</a></span><span class="line">        <span class="var type0" id="S86T0U1334">distTemp</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253">253</a></span><span class="line">        <span class="keyword">if</span>(~<span class="var type0" id="S15T0U1340">nonCycleFlag</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254">254</a></span><span class="line">            <span class="keyword">while</span>(~<span class="var type0" id="S81T0U1345">isOnBridge</span>(<span class="var type0" id="S85T0U1346">vertInd</span>)) <span class="comment">%should short circuit</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line">                <span class="var type0" id="S87T0U1349">edgeTraversal</span> = <span class="var type0" id="S34T0U1351">parentEdge</span>(<span class="var type0" id="S13T0U1353">r2sV</span>(<span class="var type0" id="S85T0U1354">vertInd</span>),1);<span class="comment">%records.halfEdge(parentEdge(r2sV(vertInd),1),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line">                <span class="var type0" id="S86T0U1358">distTemp</span> = <span class="var type0" id="S86T0U1360">distTemp</span> + <span class="var type0" id="S4T0U1363">E</span>.dist(<span class="var type0" id="S87T0U1365">edgeTraversal</span>);<span class="comment">%edgeTraversal(5);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line">                <span class="var type0" id="S85T0U1368">vertInd</span> = <span class="var type0" id="S4T0U1371">E</span>.origin(<span class="var type0" id="S87T0U1373">edgeTraversal</span>,2);<span class="comment">%edgeTraversal(4);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line">            <span class="keyword">while</span>(<span class="var type0" id="S34T0U1380">parentEdge</span>(<span class="var type0" id="S13T0U1382">r2sV</span>(<span class="var type0" id="S85T0U1383">vertInd</span>),1) ~= -1)</span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line">                <span class="var type0" id="S87T0U1389">edgeTraversal</span> = <span class="var type0" id="S34T0U1391">parentEdge</span>(<span class="var type0" id="S13T0U1393">r2sV</span>(<span class="var type0" id="S85T0U1394">vertInd</span>),1);<span class="comment">%records.halfEdge(parentEdge(r2sV(vertInd),1),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262">262</a></span><span class="line">                <span class="var type0" id="S86T0U1398">distTemp</span> = <span class="var type0" id="S86T0U1400">distTemp</span> + <span class="var type0" id="S4T0U1403">E</span>.dist(<span class="var type0" id="S87T0U1405">edgeTraversal</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263">263</a></span><span class="line">                <span class="var type0" id="S85T0U1408">vertInd</span> = <span class="var type0" id="S4T0U1411">E</span>.origin(<span class="var type0" id="S87T0U1413">edgeTraversal</span>,2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264">264</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265">265</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line">        <span class="var type0" id="S83T0U1418">vertTerminal_circList_rootNode</span>(<span class="var type0" id="S60T0U1419">i</span>) = <span class="var type0" id="S85T0U1420">vertInd</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line">        <span class="keyword">if</span>(<span class="var type0" id="S34T0U1426">parentEdge</span>(<span class="var type0" id="S32T0U1428">vertexTerminal_circList</span>(<span class="var type0" id="S60T0U1429">i</span>),2) ~= 0)</span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line">            <span class="var type0" id="S88T0U1434">distTempB</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269">269</a></span><span class="line">            <span class="var type0" id="S85T0U1438">vertInd</span> = (<span class="var type0" id="S32T0U1441">vertexTerminal_circList</span>(<span class="var type0" id="S60T0U1442">i</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270">270</a></span><span class="line">            <span class="var type0" id="S87T0U1445">edgeTraversal</span> = <span class="var type0" id="S34T0U1447">parentEdge</span>(<span class="var type0" id="S85T0U1448">vertInd</span>,2);<span class="comment">%parentEdge(vertInd,2)records.halfEdge(parentEdge(vertInd,2),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271">271</a></span><span class="line">            <span class="var type0" id="S88T0U1452">distTempB</span> = <span class="var type0" id="S88T0U1454">distTempB</span> + <span class="var type0" id="S4T0U1457">E</span>.dist(<span class="var type0" id="S87T0U1459">edgeTraversal</span>);<span class="comment">%edgeTraversal(5);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272">272</a></span><span class="line">            <span class="var type0" id="S85T0U1462">vertInd</span> = <span class="var type0" id="S4T0U1465">E</span>.origin(<span class="var type0" id="S87T0U1467">edgeTraversal</span>,2);<span class="comment">%edgeTraversal(4);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273">273</a></span><span class="line">            <span class="keyword">if</span>(~<span class="var type0" id="S15T0U1473">nonCycleFlag</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274">274</a></span><span class="line">                <span class="keyword">while</span>(~<span class="var type0" id="S81T0U1478">isOnBridge</span>(<span class="var type0" id="S85T0U1479">vertInd</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275">275</a></span><span class="line">                    <span class="var type0" id="S87T0U1482">edgeTraversal</span> = <span class="var type0" id="S34T0U1484">parentEdge</span>(<span class="var type0" id="S13T0U1486">r2sV</span>(<span class="var type0" id="S85T0U1487">vertInd</span>),1);<span class="comment">%records.halfEdge(parentEdge(r2sV(vertInd),1),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276">276</a></span><span class="line">                    <span class="var type0" id="S88T0U1491">distTempB</span> = <span class="var type0" id="S88T0U1493">distTempB</span> + <span class="var type0" id="S4T0U1496">E</span>.dist(<span class="var type0" id="S87T0U1498">edgeTraversal</span>);<span class="comment">%edgeTraversal(5);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277">277</a></span><span class="line">                    <span class="var type0" id="S85T0U1501">vertInd</span> = <span class="var type0" id="S4T0U1504">E</span>.origin(<span class="var type0" id="S87T0U1506">edgeTraversal</span>,2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278">278</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279">279</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280">280</a></span><span class="line">                <span class="keyword">while</span>(<span class="var type0" id="S34T0U1513">parentEdge</span>(<span class="var type0" id="S13T0U1515">r2sV</span>(<span class="var type0" id="S85T0U1516">vertInd</span>),1) ~= -1)</span></span>
<span class="srcline"><span class="lineno"><a href="1,281" id="srcline281">281</a></span><span class="line">                    <span class="var type0" id="S87T0U1522">edgeTraversal</span> = <span class="var type0" id="S34T0U1524">parentEdge</span>(<span class="var type0" id="S13T0U1526">r2sV</span>(<span class="var type0" id="S85T0U1527">vertInd</span>),1);<span class="comment">%records.halfEdge(parentEdge(r2sV(vertInd),1),:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,282" id="srcline282">282</a></span><span class="line">                    <span class="var type0" id="S88T0U1531">distTempB</span> = <span class="var type0" id="S88T0U1533">distTempB</span> + <span class="var type0" id="S4T0U1536">E</span>.dist(<span class="var type0" id="S87T0U1538">edgeTraversal</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,283" id="srcline283">283</a></span><span class="line">                    <span class="var type0" id="S85T0U1541">vertInd</span> = <span class="var type0" id="S4T0U1544">E</span>.origin(<span class="var type0" id="S87T0U1546">edgeTraversal</span>,2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,284" id="srcline284">284</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,285" id="srcline285">285</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286">286</a></span><span class="line">            <span class="keyword">if</span>(<span class="var type0" id="S88T0U1552">distTempB</span> &lt; <span class="var type0" id="S86T0U1553">distTemp</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287">287</a></span><span class="line">                <span class="var type0" id="S86T0U1556">distTemp</span> = <span class="var type0" id="S88T0U1557">distTempB</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288">288</a></span><span class="line">                <span class="var type0" id="S83T0U1561">vertTerminal_circList_rootNode</span>(<span class="var type0" id="S60T0U1562">i</span>) = <span class="var type0" id="S85T0U1563">vertInd</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289">289</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290">290</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291">291</a></span><span class="line">        <span class="var type0" id="S82T0U1567">distMat</span>(<span class="var type0" id="S60T0U1568">i</span>) = <span class="var type0" id="S86T0U1569">distTemp</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292">292</a></span><span class="line">        <span class="keyword">if</span>(<span class="var type0" id="S86T0U1576">distTemp</span> - <span class="var type0" id="S3T0U1579">V</span>.rad(<span class="var type0" id="S83T0U1582">vertTerminal_circList_rootNode</span>(<span class="var type0" id="S60T0U1583">i</span>)) &lt; 0 &amp;&amp; <span class="var type0" id="S86T0U1587">distTemp</span> - <span class="var type0" id="S3T0U1590">V</span>.rad(<span class="var type0" id="S83T0U1593">vertTerminal_circList_rootNode</span>(<span class="var type0" id="S60T0U1594">i</span>)) &gt; -sqrt(eps))</span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293">293</a></span><span class="line">            <span class="var type0" id="S82T0U1603">distMat</span>(<span class="var type0" id="S60T0U1604">i</span>) = <span class="var type0" id="S3T0U1607">V</span>.rad(<span class="var type0" id="S83T0U1610">vertTerminal_circList_rootNode</span>(<span class="var type0" id="S60T0U1611">i</span>));<span class="comment">%records.vorVert(vertTerminal_circList_rootNode(i),3);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294">294</a></span><span class="line">            <span class="comment">%         disp('Minor precision error in radius caught and accounted for<span class="keyword">...</span><span class="comment">');</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line">        <span class="keyword">elseif</span>(<span class="var type0" id="S86T0U1616">distTemp</span> - <span class="var type0" id="S3T0U1619">V</span>.rad(<span class="var type0" id="S83T0U1622">vertTerminal_circList_rootNode</span>(<span class="var type0" id="S60T0U1623">i</span>)) &lt;= -sqrt(eps))</span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line">            disp(<span class="string">'Severe precision error detected, review loop plots'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297">297</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298">298</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299">299</a></span><span class="line">    <span class="var type0" id="S2T0U1636">betweenness</span>(<span class="var type0" id="S23T0U1637">vsp</span>) = sum(<span class="var type0" id="S82T0U1640">distMat</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300">300</a></span><span class="line">    <span class="comment">% loopStruct.isRootNode = isOnBridge;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line">    <span class="comment">% loopStruct.parEdge = parentEdge;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line">    <span class="comment">% loopStruct.boundaryVerts = s2rV(vertexTerminal_circList);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line">    <span class="comment">% loopStruct.boundaryVertexCoor = boundaryVertexCoor; %Num = perim, Area requires calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line">    <span class="comment">% loopStruct.boundaryProfile = distMat;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line">    <span class="comment">% loopStruct.boundaryToCycleNode = vertTerminal_circList_rootNode;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line">    <span class="comment">% loopStruct.boundaryRatio = distMat./V.rad(vertTerminal_circList_rootNode);%records.vorVert(vertTerminal_circList_rootNode,3);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line">    <span class="comment">% loopStruct.boundaryDiff = distMat - V.rad(vertTerminal_circList_rootNode);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
